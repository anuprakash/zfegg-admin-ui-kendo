/*! zfegg-admin-ui-kendo 2016-03-08 */
'use strict';
define("jquery",function(){return jQuery}),define("kendo",function(){return kendo}),define("cookie",function(){return Cookies}),define("base64",function(){return Base64}),function(a,b){a["src/app/zfegg/admin/controller/assign-resource.html"]='<div data-role="window"\n     data-modal="true"\n     data-actions="[\'Close\']"\n     data-title="角色权限分配"\n     data-width="600"\n     data-height="350"\n     data-visible="true"\n     data-bind="center: onWindowClose, events: {close: onWindowClose}"\n        >\n    <div class="k-edit-form-container">\n        <div data-role="treeview"\n             data-checkboxes="{checkChildren: true}"\n             data-text-field="description"\n             data-bind="source: resources, visible: isVisible, events: {check: onCheckResource}"\n             data-messages=\'{\n         retry: "重试",\n    requestFailed: "读取错误.",\n    loading: "加载中..."\n    }\'\n                ></div>\n        <div class="k-edit-buttons k-state-default">\n            <a class="k-button k-button-icontext k-primary k-grid-update" href="#"\n               data-bind="click: onButtonSubmit"><span class="k-icon k-update"></span>确认</a>\n            <a class="k-button k-button-icontext k-grid-cancel" href="#" data-bind="click: onButtonCancel"><span\n                    class="k-icon k-cancel"></span>取消</a>\n        </div>\n    </div>\n</div>',a["src/app/zfegg/admin/controller/assign-role.html"]='<div data-role="window"\n     data-modal="true"\n     data-actions="[\'Close\']"\n     data-title="用户角色分配"\n     data-width="600"\n     data-height="350"\n     data-visible="true"\n     data-bind="center: onWindowClose, events: {close: onWindowClose}"\n        >\n    <div data-role="treeview"\n         data-checkboxes="true"\n         data-text-field="name"\n         data-bind="source: roles, visible: isVisible, events: {check: onCheckRole}"\n         data-messages=\'{\n         retry: "重试",\n    requestFailed: "读取错误.",\n    loading: "加载中..."\n    }\'\n            ></div>\n\n</div>',a["src/app/zfegg/admin/controller/profile.html"]='<form data-bind="events: {submit: onSubmit}">\n    <div class="k-edit-form-container" style="width: 400px;">\n\n        <div class="k-edit-label"><label>账号</label></div>\n        <div class="k-edit-field" data-bind="text: username">\n        </div>\n        <div class="k-edit-label"><label>密码</label></div>\n        <div data-container-for="password" class="k-edit-field">\n            <input type="password" class="k-input k-textbox" name="password" minlength="6" maxlength="20"\n                   placeholder="不修改密码无需输入"/>\n        </div>\n\n        <div class="k-edit-label"><label>确认密码</label></div>\n        <div data-container-for="confirm_password" class="k-edit-field">\n            <input type="password" class="k-input k-textbox" name="confirm_password" minlength="6" maxlength="20"\n                   placeholder="不修改密码无需输入" data-bind="events: {blur: onConfirmPassword, keyup: onConfirmPassword}"/>\n        </div>\n\n        <div class="k-edit-label"><label>真实姓名</label></div>\n        <div data-container-for="real_name" class="k-edit-field">\n            <input class="k-input k-textbox" name="real_name" required="required"\n                   data-bind="value:real_name"/>\n        </div>\n\n        <div class="k-edit-label"><label>Email</label></div>\n        <div data-container-for="email" class="k-edit-field">\n            <input class="k-input k-textbox" name="email" required="required"\n                   data-bind="value:email"/>\n        </div>\n\n        <div class="k-edit-label"></div>\n        <div class="k-edit-field">\n            <button class="k-button k-button-icontext k-primary k-grid-update"><span class="k-icon k-update"></span>确认\n            </button>\n        </div>\n    </div>\n</form>\n<script>\n    $(".admin-self").kendoValidator({\n        messages: {\n            required: "请输入此项!",\n            confirm_password: "两次输入的密码不一致"\n        },\n        rules: {\n            confirm_password: function (input) {\n                if (input.is(\'[name=confirm_password]\')) {\n                    return input.val() == $(".admin-self input[name=password]").val();\n                }\n                return true;\n            }\n        }\n    }).submit(function () {\n        var $this = $(this), $submit = $this.find(\'.k-button > span\');\n'+"        $submit.toggleClass('k-i-tick').toggleClass('k-loading');\n        $.ajax({\n            url: './admin/index/self',\n            data: $(this).serialize(),\n            success: function (result) {\n                if (!result.code) {\n                    for (var i in result.errors) {\n                        for (var j in result.errors[i]) {\n                            alert(result.errors[i][j]);\n                        }\n                    }\n                }\n            },\n            complete: function () {\n                $submit.toggleClass('k-i-tick').toggleClass('k-loading');\n            }\n        });\n        return false;\n    });\n\n\n</script>",a["src/app/zfegg/admin/controller/resource.html"]='<table\n        data-role="grid"\n        data-selectable="true"\n        data-bind="source: dataSource"\n        data-columns=\'[\n                {field: "resource", title: "权限(资源)"},\n                {field: "type", title: "类型", width: "100px"},\n                {field: "description", title: "描述", width: "120px"},\n                {field: "methods", title: "允许请求方式", width: "200px", template: "#:methods.join(\\",\\")#"},\n                {field: "actions", title: "执行动作", template: "#:actions.join(\\",\\")#"}\n            ]\'\n        >\n</table>',a["src/app/zfegg/admin/controller/role.html"]='<br>\n<div data-role="toolbar"><button data-bind="disabled: isAssignDisabled, click: onClickAssign" data-role="button">分配权限</button></div>\n<hr />\n<div data-role="treeview"\n     data-text-field="name"\n     data-bind="source: roles, visible: isVisible, events: {select: onSelect}"\n     data-messages=\'{\n     retry: "重试",\nrequestFailed: "读取错误.",\nloading: "加载中..."\n}\'\n        ></div>\n',a["src/app/zfegg/admin/controller/user.html"]='<table\n        data-role="grid"\n        data-selectable="true"\n        data-editable="popup"\n        data-pageable="1"\n        data-bind="source: dataSource, events: {change: onChange, dataBound: onDataBound, edit: onEdit}"\n        data-toolbar=\'[\n        { name: "create", "text":"增加账号" },\n        {"text":"分配角色","name":"assign", "attr": {"disabled":"disabled"}}\n    ]\'\n        data-columns=\'[\n                {field: "user_id", title: "用户ID", width: "100px"},\n                {field: "account", title: "用户名", width: "100px"},\n                {field: "real_name", title: "真实姓名", width: "120px"},\n                {field: "email", title: "Email", width: "200px",},\n                {field: "create_time", title: "添加时间", width: "200px",},\n                {field: "status", type: "enums", title: "状态", values: [\n                    {text: "开启", value: "0"},\n                    {text: "禁用", value: "1"}\n                ], width: "100px"},\n                {field: "password", title: "密码", template: "", hidden: true},\n                {\n                    command: [\n                        {"name": "edit", "text": "编辑"},\n                        {"name": "destroy", "text": "删除"}\n                    ], title: "&nbsp;"\n                }\n            ]\'\n        >\n</table>'}(this.templates=this.templates||{}),function(a){var b="src/";for(var c in a)a[c.replace(b,"")]=a[c],delete a[c]}(this.templates),define("zfegg/admin/controller/profile",["require","kendo","zfegg/model/view","zfegg/config","zfegg/ui/notification"],function(a,b,c,d,e){"use strict";var f=d.baseUrl+"/profile/index",g={onSubmit:function(a){a.preventDefault();var b=$(a.target).serializeArray();b=b.filter(function(a,b){return a.value.length>0}),$.ajax({type:"PUT",url:f,data:b,success:function(){e.success("修改成功")}})},onConfirmPassword:function(a){var b=$(a.target).closest("form").find("[name=password]").get(0),c=a.target;b.value!=c.value?c.setCustomValidity("输入的密码不一致"):c.setCustomValidity("")}};return new c("个人信息",a.toUrl("./profile.html"),{model:{onSubmit:function(a){a.preventDefault()}},init:function(a){var c=this;$.get(f,function(a){b.bind(c.element,$.extend(a,g))})}})}),define("zfegg/admin/controller/resource",["require","zfegg/model/view","zfegg/config","../source/resources"],function(a,b,c,d){"use strict";return new b("资源管理",a.toUrl("./resource.html"),{model:{dataSource:d}})}),define("zfegg/admin/controller/role",["require","zfegg/model/view","zfegg/config","../source/roles","../source/role-resources","zfegg/kendo/binder-window-center"],function(a,b,c,d,e){"use strict";c.baseUrl+"/roles";return new b("角色管理",a.toUrl("./role.html"),{model:{roles:d.hierarchicalDataSource,isAssignDisabled:!0,isVisible:!0,selectedNode:null,onSelect:function(a){var b=a.sender.element.data("kendoTreeView");this.selectedNode=b.dataItem(a.node),this.set("isAssignDisabled",!1)},onClickAssign:function(c){var d=new e(this.selectedNode);d.fetchItems(function(c){var e=new b("",a.toUrl("./assign-resource.html"),{model:{isVisible:!0,onCheckResource:function(a){var b=a.sender.dataItem(a.node);d.assign(b)},onWindowClose:function(a){a.sender.destroy()},onButtonSubmit:function(a){a.preventDefault(),d.dataSource.sync().then(function(){$(a.target).closest("[data-role=window]").data("kendoWindow").close()})},onButtonCancel:function(a){a.preventDefault(),$(a.target).closest("[data-role=window]").data("kendoWindow").close()},resources:c}});e.render()})}},init:function(){var a=this.element.children("[data-role=treeview]"),b=a.data("kendoTreeView");b.options.template=kendo.template('<span>#:item.name#</span>  <span class="k-icon k-add"></span> <span class="k-icon k-delete"></span>'),a.on("click",".k-delete",function(){var a=$(this).closest(".k-item"),c=(b.dataItem(a),a.find(".k-item").andSelf());c.each(function(){var a=d.dataSource.get(b.dataItem(this).role_id);a&&d.dataSource.remove(a)}),d.dataSource.sync().then(function(){b.remove(a)})}),a.on("click",".k-add",function(){var a=$(this).closest(".k-item"),c=b.dataItem(a),e=window.prompt("请输入角色名");e&&(d.dataSource.add({name:e,parent_id:c.role_id}),d.dataSource.sync().then(function(){var c=d.dataSource.data().slice(-1)[0];b.append(c.toJSON(),a)}))})}})}),define("zfegg/admin/controller/user",["require","zfegg/model/view","zfegg/config","zfegg/kendo/restful-data-source","../source/user-roles","zfegg/kendo/binder-window-center"],function(a,b,c,d,e){"use strict";var f,g=c.baseUrl+"/users";return new b("用户管理",a.toUrl("./user.html"),{model:{dataSource:new d({url:g,schema:{model:{id:"user_id",fields:{user_id:{type:"number",editable:!1,nullable:!0},account:{validation:{required:!0}},real_name:{validation:{required:!0}},email:{validation:{email:!0,required:!0}},status:{defaultValue:0},password:{editable:!0,validation:{min:6,max:20,required:!0}},create_time:{defaultValue:null,editable:!1}}}},error:function(a){return d.gridErrorStatusListener(a,f)}}),onChange:function(a){f=a.sender,f.wrapper.find(".k-grid-assign").removeAttr("disabled")},onEdit:function(a){if(!a.model.isNew()){a.container.find("input[name=account]").attr("disabled",!0)}},onDataBound:function(c){f=c.sender,f.wrapper.on("click",".k-grid-assign",function(c){if(!$(this).is("[disabled]")&&f.select().length){var d=f.dataItem(f.select()),g=new e(d),h=new b("",a.toUrl("./assign-role.html"),{model:{roles:g.hierarchicalDataSource,isVisible:!0,onCheckRole:function(a){var b=a.sender.dataItem(a.node);g.assign(b)},onWindowClose:function(a){a.sender.destroy()}}});h.render()}})}}})}),define("zfegg/admin/init",["zfegg/router","zfegg/ui/tabs"],function(a,b){"use strict";a.route("/zfegg/admin/:action",function(a){b.dispatchController("zfegg/admin/controller/"+a)})}),define("zfegg/admin/source/resources",["kendo","zfegg/config","zfegg/kendo/restful-data-source"],function(a,b,c){"use strict";var d=b.baseUrl+"/resources";return new c({url:d,schema:{model:{id:"resource",fields:{resource:{editable:!1},type:{editable:!1},description:{},methods:{},actions:{}}}}})}),define("zfegg/admin/source/role-resources",["jquery","kendo","zfegg/config","zfegg/kendo/restful-data-source","./resources"],function(a,b,c,d,e){"use strict";var f=function(f){var g=this,h=c.baseUrl+"/roles/"+f.role_id+"/resources",i=new d({url:h,schema:{model:{id:"id",fields:{id:{type:"number"},resource:{editable:!1},description:{},methods:{}}}}}),j=[],k=new b.data.HierarchicalDataSource({transport:{read:function(b){var c=b.data.role_id||0;g.dataSource.promise().then(function(){e.promise().then(function(){j=e.data().toJSON(),a.map(j,function(a){return g.getByResource(a.resource)&&(a.checked=!0),a}),b.success(a.grep(j,function(a){return a.parent_id==c}))})})}},schema:{parse:function(b){return a.map(b,function(a){return a.expanded=!0,a})},model:{id:"role_id",hasChildren:function(a){for(var b=a.role_id,c=0;c<j.length;c++)if(j[c].parent_id==b)return!0;return!1}}}});this.dataSource=i,this.hierarchicalDataSource=k};f.prototype.assign=function(b){var c=this;if(!b.method)return b.items.length||b.load(),void a.each(b.items,function(a,b){c.assign(b)});var d=b.parent().parent(),e=d.actions;b.checked?a.each(e,function(e,f){var g=d.resource+"::"+f,h=c.getByResource(g);h||(h=c.dataSource.add({resource:g,methods:[]})),h.methods.push(b.method),"PUT"==b.method?h.methods.push("PATCH"):"PATCH"==b.method&&h.methods.push("PUT"),h.set("methods",a.unique(h.methods)),console.log(h.methods)}):a.each(e,function(a,e){var f=d.resource+"::"+e,g=c.getByResource(f);g&&(g.methods.splice(g.methods.indexOf(b.method),1),"PUT"==b.method?g.methods.splice(g.methods.indexOf("PATCH"),1):"PATCH"==b.method&&g.methods.splice(g.methods.indexOf("PUT"),1),g.methods.length?g.set("methods",g.methods):c.dataSource.remove(g))})},f.prototype.getByResource=function(a){return this.dataSource.data().find(function(b){return b.resource==a})};var g={POST:"增",DELETE:"删",PUT:"改",PATCH:"改",GET:"查"};return f.prototype.fetchItems=function(b){var c=this;c.dataSource.promise().then(function(){var d={};a.each(c.dataSource.data().toJSON(),function(b,c){a.each(c.methods,function(a,b){d[c.resource+"::"+b]=!0})});var f=function(a,b){for(var c=0;c<a.actions.length;c++)if(d[a.resource+"::"+a.actions[c]+"::"+b])return!0;return!1};e.promise().then(function(){var c=e.data().toJSON();c=c.filter(function(a){return a.methods?a.methods.length>0:!0}),a.map(c,function(b){var c={};return b.items=[],a.each(b.methods,function(a,d){var e={description:g[d],method:d,checked:f(b,d)};c[g[d]]||(c[g[d]]=e,b.items.push(e),b.checked=b.checked||e.checked)}),b}),b(c)})})},f}),define("zfegg/admin/source/roles",["jquery","kendo","zfegg/config","zfegg/kendo/restful-data-source"],function(a,b,c,d){"use strict";var e=c.baseUrl+"/roles",f=new d({url:e,schema:{model:{id:"role_id",fields:{role_id:{type:"number",editable:!1,nullable:!0},name:{validation:{required:!0}},parent_id:{validation:{required:!0}}}}}}),g=[],h=new b.data.HierarchicalDataSource({transport:{read:function(b){var c=b.data.role_id||0;f.promise().then(function(){g=f.data().toJSON(),b.success(a.grep(g,function(a){return a.parent_id==c}))})}},schema:{parse:function(b){return a.map(b,function(a){return a.expanded=!0,a})},model:{id:"role_id",hasChildren:function(a){for(var b=a.role_id,c=0;c<g.length;c++)if(g[c].parent_id==b)return!0;return!1}}}});return{dataSource:f,hierarchicalDataSource:h}}),define("zfegg/admin/source/user-roles",["jquery","kendo","zfegg/config","zfegg/kendo/restful-data-source","./roles"],function(a,b,c,d,e){"use strict";var f=function(f){var g=this,h=c.baseUrl+"/users/"+f.user_id+"/roles",i=new d({url:h,transport:{destroy:{url:function(a){return h+"/"+a.role_id}}},schema:{parse:function(c){if(c._embedded&&c._embedded.user_roles){var d=c._embedded.user_roles;return a.map(d,function(a){return a.non_id=b.guid(),a}),d.non_id=b.guid(),d}return c},model:{id:"non_id",fields:{non_id:{},role_id:{},name:{},parent_id:{}}}}}),j=[],k=new b.data.HierarchicalDataSource({transport:{read:function(b){var c=b.data.role_id||0;g.dataSource.promise().then(function(){e.dataSource.promise().then(function(){j=e.dataSource.data().toJSON(),a.map(j,function(a){return g.getByRoleId(a.role_id)&&(a.checked=!0),a}),b.success(a.grep(j,function(a){return a.parent_id==c}))})})}},schema:{parse:function(b){return a.map(b,function(a){return a.expanded=!0,a})},model:{id:"role_id",hasChildren:function(a){for(var b=a.role_id,c=0;c<j.length;c++)if(j[c].parent_id==b)return!0;return!1}}}});this.dataSource=i,this.hierarchicalDataSource=k};return f.prototype.assign=function(a){if(a.checked)this.dataSource.add({role_id:a.role_id});else{var b=this.getByRoleId(a.role_id);this.dataSource.remove(b)}this.dataSource.sync()},f.prototype.getByRoleId=function(a){return this.dataSource.data().find(function(b){return b.role_id==a})},f}),define("zfegg/config",function(){return{baseUrl:"",oauth:{clientId:null,clientSecret:null},title:"Zfegg Admin"}}),define("zfegg/kendo/binder-window-center",["kendo"],function(a){a.data.binders.widget.center=a.data.Binder.extend({init:function(b,c,d){a.data.Binder.fn.init.call(this,b,c,d),b.center()},refresh:function(){}})}),define("zfegg/kendo/restful-data-source",["kendo"],function(a){var b="application/json",c={data:function(a){if(!a._embedded)return a;if(this.dataKey)return a._embedded[this.dataKey];for(var b in a._embedded)return a._embedded[b]},dataKey:null,total:"total_items"},d=a.data.DataSource.extend({init:function(d){var e=this,f=d.schema.model&&d.schema.model.id||"id",g={read:{url:d.url},create:{url:d.url}},h={read:{url:null,type:"GET",dataType:"json"},create:{url:null,type:"POST",dataType:"json",contentType:b},update:{url:function(a){return d.url+"/"+a[f]},type:"PATCH",dataType:"json",contentType:b},destroy:{url:function(a){return d.url+"/"+a[f]},type:"DELETE",dataType:"json",contentType:b},parameterMap:function(a,b){if("update"==b){var c=e._pristineForModel(e.get(a[f])),d=$.extend({},a);for(var g in d){var h=d[g];"object"!=typeof h&&"function"!=typeof h&&h==c[g]&&delete d[g]}return delete d._links,JSON.stringify(d)}return"create"==b||"destroy"==b?JSON.stringify(a):a}};d.schema=$.extend(c,d.schema||{}),d.transport=$.extend(g,d.transport||{}),d.transport=$.extend(!0,h,d.transport),a.data.DataSource.fn.init.call(this,d)},promise:function(){return this._promiseCaller||(this._promiseCaller=this.fetch()),this._promiseCaller},_promiseCaller:null});return d.gridErrorStatusListener=function(b,c){if(422==b.xhr.status&&b.xhr.responseJSON&&b.xhr.responseJSON.validation_messages){var d=c.editable.element.data("kendoValidator"),e=b.xhr.responseJSON.validation_messages;for(var f in e){var g=d.element.find("[name="+f+"]");for(var h in e[f]){var i=e[f][h];$(a.template(d.options.errorTemplate)({message:i})).insertAfter(g),g.focus()}}}},d}),define("zfegg/model/oauth",["jquery","cookie","base64"],function(a,b,c){var d=function(a){this.obj=a,this.events={}};d.prototype.bind=function(a,b){this.events[a]||(this.events[a]=[]),this.events[a].push(b)},d.prototype.trigger=function(b){var c=this;if(this.events[b]){var d=Array.prototype.slice.call(arguments,1);a.each(this.events[b],function(a,b){b.apply(c.obj,d)})}};var e=function(a,b,c,e){this.KEY=e||"zfegg_oauth",this.KEY_PASSWORD=this.KEY+"_password",this.path=a,this.clientId=b,this.clientSecret=c,this.event=new d(this),this.isLogin()&&this._setLoginSuccess()};e.prototype.isLogin=function(){return Boolean(b.getJSON(this.KEY_PASSWORD))},e.prototype._setLoginSuccess=function(c){if(c){var d={};if(c.expires_in){var e=new Date;e.setTime(e.getTime()+1e3*c.expires_in),d.expires=e}b.set(this.KEY_PASSWORD,c,d)}a.ajaxSetup({headers:{Authorization:this.getBearer()}})};var f=!1;return e.prototype.login=function(b,c){var d=this;return f?this.event:(a.ajax(a.extend(c,{type:"POST",url:d.path,dataType:"json",headers:{Authorization:this.getBasic()},data:a.extend(b,{grant_type:"password"}),success:function(a){d._setLoginSuccess(a),d.event.trigger("login.success",a)},error:function(a){d.event.trigger("login.error",a)},complete:function(a){f=!1,d.event.trigger("login.complete",a)}})),f=!0,this.event)},e.prototype.getBearer=function(){if(!this.isLogin())throw new Error("Please login.");return"Bearer "+b.getJSON(this.KEY_PASSWORD).access_token},e.prototype.getBasic=function(){return"Basic "+c.encode(this.clientId+":"+this.clientSecret)},e.prototype.bind=function(){var a=Array.prototype.slice.call(arguments);return this.event.bind.apply(this.event,a),this},e.prototype.trigger=function(){var a=Array.prototype.slice.call(arguments);return this.event.trigger.apply(this.event,a),this},e.prototype.logout=function(){b.set(this.KEY_PASSWORD,null,{expires:0}),delete a.ajaxSettings.headers.Authorization},e}),define("zfegg/model/view",["jquery","kendo"],function(a,b){var c=function(b,c,d){var e={title:"",tmpl:"",renderOptions:{}};"object"==typeof c?this.options=a.extend(e,c):this.options={title:b,tmpl:c,renderOptions:d},this.title=this.options.title};return c.prototype.render=function(c,d){"function"==typeof c&&(d=c,c=void 0);var e=this.options,f=this,g=function(a){var g=new b.View(a,e.renderOptions),h=g.render(c);f.kendoView=g,d&&d(h,g)},h=e.tmpl.replace(/^.\//,"");window.templates&&window.templates[h]?setTimeout(function(){g(window.templates[h])},0):a.get(e.tmpl,g)},c}),define("zfegg/router",["kendo"],function(a){return new kendo.Router({routeMissing:function(a){console.log("Route missing",a.url,a.params)}})}),define("zfegg/service/oauth",["../model/oauth","zfegg/config"],function(a,b){return new a(b.baseUrl+"/oauth",b.oauth.clientId,b.oauth.clientSecret)}),define("zfegg/ui/init",["require","jquery","kendo","zfegg/model/view","zfegg/config","zfegg/router","./tabs","../service/oauth"],function(a,b,c,d,e,f,g,h){"use strict";var i=function(){var a=b("body div[data-role=panelbar]");g.push(b("body [data-role=tabstrip]").get(0));var d=c.observable({onSelectPanel:function(a){a.preventDefault(),console.log("onSelectPanel")},onSelectTabstrip:function(a){console.log("onSelectTabstrip")}});c.bind(b("#zfegg-admin").show(),d);var f=e.baseUrl;b.get(f+"/profile/menus",function(b){a.data("kendoPanelBar").append(b._embedded.menus)})},j=function(){var a=b("#zfegg-login"),d=c.observable({isVisible:!0,onSubmit:function(a){return a.preventDefault(),h.login({username:a.target.username.value,password:a.target.password.value}),!1}});h.bind("login.success",function(){d.set("isVisible",!1),i()}).bind("login.error",function(c){var d="登录错误";d=/application\/[\w\+]*json/.test(c.getResponseHeader("Content-Type"))&&c.responseJSON&&c.responseJSON.detail?c.responseJSON.detail:c.status+" "+c.statusText,b("<div></div>").kendoNotification({appendTo:a,autoHideAfter:1500}).data("kendoNotification").error(d)}),c.bind(a,d),a.show()};b.ajaxSetup({error:function(a){console.log("error",a);var b="系统错误";b=/application\/[\w\+]*json/.test(a.getResponseHeader("Content-Type"))&&a.responseJSON&&a.responseJSON.detail?"<span>错误("+a.status+"): "+a.statusText+"</span><br />"+a.responseJSON.detail:b+": "+a.status+" "+a.statusText,require(["zfegg/ui/notification"],function(a){a.error(b)})}}),h.isLogin()?i():j(),document.title=e.title,location.hash.length>1&&(location.hash="")}),define("zfegg/ui/notification",["jquery","kendo"],function(a){"use strict";return a("#notification").kendoNotification().data("kendoNotification")}),define("zfegg/ui/tabs",["jquery","kendo"],function(a){"use strict";var b=a(),c=document.title,d=!1,e=function(b){d||(d=!0,b.data("kendoTabStrip").bind("select",function(b){a(b.item).data("location")&&(window.location.hash=a(b.item).data("location"))}))};return b.dispatchController=function(d){var f=this.data("kendoTabStrip"),g=this.data("routers")||{};return e(this),g[window.location.hash]?(f.activateTab(g[window.location.hash].tab),document.title=g[window.location.hash].view.title+" - "+c):require([d],function(d){"function"==typeof d.render&&d.render(function(e){f.append([{text:d.title,content:""}]).activateTab("li:last");var h=f.items()[f.items().length-1],i=a(f.contentElement(f.items().length-1));i.empty(),i.append(e),g[window.location.hash]={tab:h,view:d},a(h).data("location",window.location.hash),b.data("routers",g),document.title=g[window.location.hash].view.title+" - "+c})}),this},b});